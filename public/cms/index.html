<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>NeoMed Admin</title>
</head>
<body>
  <script src="https://unpkg.com/decap-cms@^3.1.0/dist/decap-cms.js"></script>
  <script>
    // Custom button to run Render Deploy Hook
    const RENDER_DEPLOY_HOOK = 'https://api.render.com/deploy/srv-d5ilgpm3jp1c73c33ol0?key=1GJxMSMivIM';
    
    // Wait for the CMS to load
    window.addEventListener('load', () => {
      setTimeout(() => {
        const deployButton = document.createElement('button');
        deployButton.textContent = 'üöÄ Deploy a Producci√≥n';
        deployButton.style.cssText = `
          position: fixed;
          bottom: 24px;
          right: 24px;
          background: #10b981;
          color: white;
          border: none;
          padding: 14px 24px;
          border-radius: 8px;
          cursor: pointer;
          font-weight: 600;
          font-size: 14px;
          transition: all 0.2s;
          box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
          z-index: 9999;
        `;
        
        deployButton.onmouseover = () => {
          deployButton.style.background = '#059669';
          deployButton.style.transform = 'translateY(-2px)';
          deployButton.style.boxShadow = '0 6px 16px rgba(16, 185, 129, 0.4)';
        };
        deployButton.onmouseout = () => {
          deployButton.style.background = '#10b981';
          deployButton.style.transform = 'translateY(0)';
          deployButton.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.3)';
        };
        
        deployButton.onclick = async () => {
          if (RENDER_DEPLOY_HOOK === 'TU_DEPLOY_HOOK_URL_AQUI') {
            alert('‚ö†Ô∏è Configura el RENDER_DEPLOY_HOOK en public/cms/index.html primero');
            return;
          }
          
          if (!confirm('¬øDesplegar cambios a producci√≥n?\n\nPor favor verifica que todos los cambios est√©n listos.')) {
            return;
          }
          
          deployButton.disabled = true;
          deployButton.textContent = '‚è≥ Desplegando...';
          deployButton.style.background = '#6b7280';
          
          try {
            // Usar no-cors porque Render no devuelve CORS headers
            await fetch(RENDER_DEPLOY_HOOK, { 
              method: 'POST',
              mode: 'no-cors' // No podemos leer la respuesta, pero s√≠ se env√≠a el request
            });
            
            // Si no hay error de red, asumimos √©xito
            deployButton.textContent = '‚úÖ Deploy iniciado';
            deployButton.style.background = '#10b981';
            setTimeout(() => {
              deployButton.textContent = 'üöÄ Deploy a Producci√≥n';
              deployButton.disabled = false;
            }, 3000);
            alert('‚úÖ Deploy iniciado!\n\nEl sitio se actualizar√° en unos minutos.');
            
          } catch (error) {
            // Solo entra aqu√≠ si hay error de red (sin internet, URL incorrecta, etc)
            deployButton.textContent = '‚ùå Error';
            deployButton.style.background = '#ef4444';
            setTimeout(() => {
              deployButton.textContent = 'üöÄ Deploy a Producci√≥n';
              deployButton.style.background = '#10b981';
              deployButton.disabled = false;
            }, 3000);
            alert('‚ùå Error de red. Verifica tu conexi√≥n.');
          }
        };
        
        document.body.appendChild(deployButton);
      }, 1000);
    });
  </script>
</body>
</html>
